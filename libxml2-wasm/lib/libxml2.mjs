import R from"./libxml2raw.mjs";import{ContextStorage as T}from"./utils.mjs";const e=await R();e._xmlInitParser();class C extends Error{}class G extends C{constructor(o,r){super(o),this.details=r}}function X(t){if(!t)return[0,0];const o=e.lengthBytesUTF8(t),r=e._malloc(o+1);return e.stringToUTF8(t,r,o+1),[r,o]}function s(t,...o){const r=o.map(l=>{const[a]=X(l);return a}),n=t(...r);return r.forEach(l=>{l&&e._free(l)}),n}function _(t,o){const[r,n]=X(t),l=o(r,n);return r&&e._free(r),l}function g(t){const o=e.UTF8ToString(t);return e._free(t),o}function h(t,o){if(!t)return o(0,0);const r=e._malloc(t.length+1);e.HEAPU8.set(t,r),e.HEAPU8[r+t.length]=0;const n=o(r,t.length);return e._free(r),n}function V(t,o,r,n,l){return _(o,(a,c)=>s(m=>e._xmlCtxtReadMemory(t,a,c,m,0,l),r))}function v(t,o,r,n,l){return h(o,(a,c)=>s(m=>e._xmlCtxtReadMemory(t,a,c,m,0,l),r))}function H(t,o,r){return s((n,l)=>e._xmlXPathRegisterNs(t,n,l),o,r)}function b(t,o,r){return s((n,l)=>e._xmlHasNsProp(t,n,l),o,r)}function B(t,o,r,n){return s((l,a)=>e._xmlSetNsProp(t,o,l,a),r,n)}function k(t){return g(e._xmlNodeGetContent(t))}function Z(t,o){return _(o,(r,n)=>e._xmlNodeSetContentLen(t,r,n))}function x(t,o){return r=>{if(r===0)throw new C("Access with null pointer");return e.getValue(r+t,o)}}function w(t){return t===0?null:e.UTF8ToString(t)}function L(t){return o=>w(e.getValue(o+t,"i8*"))}function S(t){return o=>{if(o===0)throw new C("Access with null pointer");return e.UTF8ToString(e.getValue(o+t,"i8*"))}}function Y(t,o){const r=e._xmlGetNsList(t,o);if(r===0)return[];const n=[];for(let l=r/e.HEAP32.BYTES_PER_ELEMENT;e.HEAP32[l];l+=1)n.push(e.HEAP32[l]);return e._free(r),n}function W(t,o,r){return s(n=>e._xmlSearchNs(t,o,n),r)}function j(t,o){return s(r=>e._xmlXPathCtxtCompile(t,r),o)}var D;(function(t){t.storage=new T,t.errorCollector=e.addFunction((o,r)=>{const n=u.file(r),l={message:u.message(r),line:u.line(r),col:u.col(r)};n!=null&&(l.file=n),t.storage.get(o).push(l)},"vii")})(D||(D={}));class N{}N.type=x(0,"i32"),N.nodesetval=x(4,"*"),N.boolval=x(8,"i32"),N.floatval=x(16,"double"),N.stringval=S(24),(function(t){let o;(function(r){r[r.XPATH_NODESET=1]="XPATH_NODESET",r[r.XPATH_BOOLEAN=2]="XPATH_BOOLEAN",r[r.XPATH_NUMBER=3]="XPATH_NUMBER",r[r.XPATH_STRING=4]="XPATH_STRING"})(o=t.Type||(t.Type={}))})(N||(N={}));class M{static nodeTable(o,r){const n=e.getValue(o+8,"*")/e.HEAP32.BYTES_PER_ELEMENT;return e.HEAP32.subarray(n,n+r)}}M.nodeCount=x(0,"i32");class i{}i.type=x(4,"i32"),i.name_=S(8),i.children=x(12,"*"),i.last=x(16,"*"),i.parent=x(20,"*"),i.next=x(24,"*"),i.prev=x(28,"*"),i.doc=x(32,"*");class F extends i{}F.namespace=x(36,"*");class E extends F{}E.properties=x(44,"*"),E.nsDef=x(48,"*"),E.line=x(56,"i32"),(function(t){let o;(function(r){r[r.XML_ELEMENT_NODE=1]="XML_ELEMENT_NODE",r[r.XML_ATTRIBUTE_NODE=2]="XML_ATTRIBUTE_NODE",r[r.XML_TEXT_NODE=3]="XML_TEXT_NODE",r[r.XML_CDATA_SECTION_NODE=4]="XML_CDATA_SECTION_NODE",r[r.XML_ENTITY_REF_NODE=5]="XML_ENTITY_REF_NODE",r[r.XML_COMMENT_NODE=8]="XML_COMMENT_NODE",r[r.XML_DTD_NODE=14]="XML_DTD_NODE"})(o=t.Type||(t.Type={}))})(E||(E={}));class P{}P.next=x(0,"*"),P.href=S(8),P.prefix=S(12);class K extends i{}class u{}u.message=S(8),u.file=L(16),u.line=x(20,"i32"),u.col=x(40,"i32");function q(t,o){return _(o,(r,n)=>e._xmlNewCDataBlock(t,r,n))}function z(t,o){return _(o,r=>e._xmlNewDocComment(t,r))}function J(t,o,r){return s(n=>e._xmlNewDocNode(t,o,n,0),r)}function Q(t,o){return _(o,(r,n)=>e._xmlNewDocTextLen(t,r,n))}function $(t,o,r){return s((n,l)=>e._xmlNewNs(t,n,l),o,r??null)}function y(t,o){return _(o,r=>e._xmlNewReference(t,r))}function ee(t){const o=e.addFunction(c=>{const m=e.UTF8ToString(c);return t.match(m)?1:0},"ii"),r=e.addFunction(c=>{const m=e.UTF8ToString(c),d=t.open(m);return d===void 0?0:d},"ii"),n=e.addFunction((c,m,d)=>t.read(c,e.HEAPU8.subarray(m,m+d)),"iiii"),l=e.addFunction(c=>t.close(c)?0:-1,"ii");return e._xmlRegisterInputCallbacks(o,r,n,l)>=0}function te(){e._xmlCleanupInputCallbacks()}function re(t){if(!t)return 1;let o=0;return t.format&&(o|=1),t.noDeclaration&&(o|=2),t.noEmptyTags&&(o|=4),o}const p=new T,A=e.addFunction((t,o,r)=>p.get(t).write(e.HEAPU8.subarray(o,o+r)),"iiii"),I=e.addFunction(t=>{const o=p.get(t).close();return p.free(t),o},"ii");function oe(t,o,r){const n=p.allocate(t);return e._xmlSaveToIO(A,I,n,0,r)}var f;(function(t){t[t.XML_INPUT_BUF_STATIC=2]="XML_INPUT_BUF_STATIC",t[t.XML_INPUT_BUF_ZERO_TERMINATED=4]="XML_INPUT_BUF_ZERO_TERMINATED",t[t.XML_INPUT_UNZIP=8]="XML_INPUT_UNZIP",t[t.XML_INPUT_NETWORK=16]="XML_INPUT_NETWORK"})(f||(f={}));function ne(t,o,r,n){return h(o,(l,a)=>{const c=e._xmlNewInputFromMemory(0,l,a,f.XML_INPUT_BUF_STATIC|f.XML_INPUT_BUF_ZERO_TERMINATED);return s((m,d)=>e._xmlCtxtParseDtd(t,c,m,d),r,n)})}function le(t,o){return _(o,r=>e._xmlSaveSetIndentString(t,r))}const xe=e._xmlAddChild,ce=e._xmlAddNextSibling,me=e._xmlAddPrevSibling,ae=e._xmlCtxtSetErrorHandler,se=e._xmlCtxtValidateDtd,ie=e._xmlDocGetRootElement,ue=e._xmlDocSetRootElement,_e=e._xmlFreeDoc,Ne=e._xmlFreeNode,de=e._xmlFreeDtd,Se=e._xmlFreeParserCtxt,Ee=e._xmlGetIntSubset,pe=e._xmlGetLastError,fe=e._xmlNewDoc,Ce=e._xmlNewParserCtxt,Pe=e._xmlRelaxNGFree,Te=e._xmlRelaxNGFreeParserCtxt,Xe=e._xmlRelaxNGFreeValidCtxt,he=e._xmlRelaxNGNewDocParserCtxt,De=e._xmlRelaxNGNewValidCtxt,Fe=e._xmlRelaxNGParse,Re=e._xmlRelaxNGSetParserStructuredErrors,ge=e._xmlRelaxNGSetValidStructuredErrors,we=e._xmlRelaxNGValidateDoc,Le=e._xmlRemoveProp,Me=e._xmlResetLastError,Ae=e._xmlSaveClose,Ie=e._xmlSaveDoc,Ue=e._xmlSaveTree,Oe=e._xmlSchemaFree,Ge=e._xmlSchemaFreeParserCtxt,Ve=e._xmlSchemaFreeValidCtxt,ve=e._xmlSchemaNewDocParserCtxt,He=e._xmlSchemaNewValidCtxt,be=e._xmlSchemaParse,Be=e._xmlSchemaSetParserStructuredErrors,ke=e._xmlSchemaSetValidStructuredErrors,Ze=e._xmlSchemaValidateDoc,Ye=e._xmlSchemaValidateOneElement,We=e._xmlSetNs,je=e._xmlUnlinkNode,Ke=e._xmlXIncludeFreeContext,qe=e._xmlXIncludeNewContext,ze=e._xmlXIncludeProcessNode,Je=e._xmlXIncludeSetErrorHandler,Qe=e._xmlXPathCompiledEval,$e=e._xmlXPathFreeCompExpr,ye=e._xmlXPathFreeContext,et=e._xmlXPathFreeObject,tt=e._xmlXPathNewContext,rt=e._xmlXPathSetContextNode;export{K as XmlAttrStruct,C as XmlError,u as XmlErrorStruct,G as XmlLibError,F as XmlNamedNodeStruct,M as XmlNodeSetStruct,E as XmlNodeStruct,P as XmlNsStruct,i as XmlTreeCommonStruct,N as XmlXPathObjectStruct,D as error,xe as xmlAddChild,ce as xmlAddNextSibling,me as xmlAddPrevSibling,te as xmlCleanupInputProvider,ne as xmlCtxtParseDtd,ae as xmlCtxtSetErrorHandler,se as xmlCtxtValidateDtd,ie as xmlDocGetRootElement,ue as xmlDocSetRootElement,_e as xmlFreeDoc,de as xmlFreeDtd,Ne as xmlFreeNode,Se as xmlFreeParserCtxt,Ee as xmlGetIntSubset,pe as xmlGetLastError,Y as xmlGetNsList,b as xmlHasNsProp,q as xmlNewCDataBlock,fe as xmlNewDoc,z as xmlNewDocComment,J as xmlNewDocNode,Q as xmlNewDocText,$ as xmlNewNs,Ce as xmlNewParserCtxt,y as xmlNewReference,k as xmlNodeGetContent,Z as xmlNodeSetContent,v as xmlReadMemory,V as xmlReadString,ee as xmlRegisterInputProvider,Pe as xmlRelaxNGFree,Te as xmlRelaxNGFreeParserCtxt,Xe as xmlRelaxNGFreeValidCtxt,he as xmlRelaxNGNewDocParserCtxt,De as xmlRelaxNGNewValidCtxt,Fe as xmlRelaxNGParse,Re as xmlRelaxNGSetParserStructuredErrors,ge as xmlRelaxNGSetValidStructuredErrors,we as xmlRelaxNGValidateDoc,Le as xmlRemoveProp,Me as xmlResetLastError,Ae as xmlSaveClose,Ie as xmlSaveDoc,re as xmlSaveOption,le as xmlSaveSetIndentString,oe as xmlSaveToIO,Ue as xmlSaveTree,Oe as xmlSchemaFree,Ge as xmlSchemaFreeParserCtxt,Ve as xmlSchemaFreeValidCtxt,ve as xmlSchemaNewDocParserCtxt,He as xmlSchemaNewValidCtxt,be as xmlSchemaParse,Be as xmlSchemaSetParserStructuredErrors,ke as xmlSchemaSetValidStructuredErrors,Ze as xmlSchemaValidateDoc,Ye as xmlSchemaValidateOneElement,W as xmlSearchNs,We as xmlSetNs,B as xmlSetNsProp,je as xmlUnlinkNode,Ke as xmlXIncludeFreeContext,qe as xmlXIncludeNewContext,ze as xmlXIncludeProcessNode,Je as xmlXIncludeSetErrorHandler,Qe as xmlXPathCompiledEval,j as xmlXPathCtxtCompile,$e as xmlXPathFreeCompExpr,ye as xmlXPathFreeContext,et as xmlXPathFreeObject,tt as xmlXPathNewContext,H as xmlXPathRegisterNs,rt as xmlXPathSetContextNode};
