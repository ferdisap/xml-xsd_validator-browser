var w=function(m,t,o,e,c,d){function a(h){if(h!==void 0&&typeof h!="function")throw new TypeError("Function expected");return h}for(var r=e.kind,s=r==="getter"?"get":r==="setter"?"set":"value",i=!t&&m?e.static?m:m.prototype:null,n=t||(i?Object.getOwnPropertyDescriptor(i,e.name):{}),f,v=!1,S=o.length-1;S>=0;S--){var _={};for(var p in e)_[p]=p==="access"?{}:e[p];for(var p in e.access)_.access[p]=e.access[p];_.addInitializer=function(h){if(v)throw new TypeError("Cannot add initializers after decoration has completed");d.push(a(h||null))};var u=(0,o[S])(r==="accessor"?{get:n.get,set:n.set}:n[s],_);if(r==="accessor"){if(u===void 0)continue;if(u===null||typeof u!="object")throw new TypeError("Object expected");(f=a(u.get))&&(n.get=f),(f=a(u.set))&&(n.set=f),(f=a(u.init))&&c.unshift(f)}else(f=a(u))&&(r==="field"?c.unshift(f):n[s]=f)}i&&Object.defineProperty(i,e.name,n),v=!0},b=function(m,t,o){for(var e=arguments.length>2,c=0;c<t.length;c++)o=e?t[c].call(m,o):t[c].call(m);return e?o:void 0},y=function(m,t,o){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(m,"name",{configurable:!0,value:o?"".concat(o," ",t):t})};import{XmlDocument as C}from"./document.mjs";import{error as l,xmlCtxtSetErrorHandler as V,xmlCtxtValidateDtd as P,XmlError as g,xmlFreeParserCtxt as G,XmlLibError as R,xmlNewParserCtxt as E,xmlRelaxNGFree as j,xmlRelaxNGFreeParserCtxt as F,xmlRelaxNGFreeValidCtxt as O,xmlRelaxNGNewDocParserCtxt as X,xmlRelaxNGNewValidCtxt as k,xmlRelaxNGParse as T,xmlRelaxNGSetParserStructuredErrors as I,xmlRelaxNGSetValidStructuredErrors as z,xmlRelaxNGValidateDoc as B,xmlSchemaFree as H,xmlSchemaFreeParserCtxt as L,xmlSchemaFreeValidCtxt as q,xmlSchemaNewDocParserCtxt as J,xmlSchemaNewValidCtxt as K,xmlSchemaParse as M,xmlSchemaSetParserStructuredErrors as Q,xmlSchemaSetValidStructuredErrors as U,xmlSchemaValidateDoc as W,xmlSchemaValidateOneElement as Y}from"./libxml2.mjs";import{disposeBy as D,XmlDisposable as N}from"./disposable.mjs";class x extends R{static fromDetails(t){return new x(t.map(o=>o.message).join(""),t)}}class re{constructor(t){this._dtd=t}validate(t){const o=E(),e=l.storage.allocate([]);V(o,l.errorCollector,e);const c=P(o,t._ptr,this._dtd._ptr),d=l.storage.get(e);if(l.storage.free(e),G(o),c!==1)throw x.fromDetails(d)}dispose(){this[Symbol.dispose]()}[Symbol.dispose](){this._dtd.dispose()}}let Z=(()=>{let m=[D(j)],t,o=[],e,c=N;var d=e=class extends c{validate(a){const r=k(this._ptr),s=l.storage.allocate([]);z(r,l.errorCollector,s);const i=B(r,a._ptr),n=l.storage.get(s);if(l.storage.free(s),O(r),i<0)throw new g("Invalid input or internal error");if(i>0)throw x.fromDetails(n)}static fromDoc(a){const r=X(a._ptr);if(r===0)throw new g("Schema is null or failed to allocate memory");const s=l.storage.allocate([]);I(r,l.errorCollector,s);const i=T(r),n=l.storage.get(s);if(l.storage.free(s),F(r),i===0)throw x.fromDetails(n);return new d(i)}};return y(e,"RelaxNGValidator"),(()=>{const a=typeof Symbol=="function"&&Symbol.metadata?Object.create(c[Symbol.metadata]??null):void 0;w(null,t={value:e},m,{kind:"class",name:e.name,metadata:a},null,o),d=e=t.value,a&&Object.defineProperty(e,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a}),b(e,o)})(),d=e})(),$=(()=>{let m=[D(H)],t,o=[],e,c=N;var d=e=class extends c{validate(a){const r=K(this._ptr),s=l.storage.allocate([]);U(r,l.errorCollector,s);const i=a instanceof C?W(r,a._ptr):Y(r,a._nodePtr),n=l.storage.get(s);if(l.storage.free(s),q(r),i<0)throw new g("Invalid input or internal error");if(i>0)throw x.fromDetails(n)}static fromDoc(a){const r=J(a._ptr);if(r===0)throw new g("Schema is null or failed to allocate memory");const s=l.storage.allocate([]);Q(r,l.errorCollector,s);const i=M(r),n=l.storage.get(s);if(l.storage.free(s),L(r),i===0)throw x.fromDetails(n);return new d(i)}};return y(e,"XsdValidator"),(()=>{const a=typeof Symbol=="function"&&Symbol.metadata?Object.create(c[Symbol.metadata]??null):void 0;w(null,t={value:e},m,{kind:"class",name:e.name,metadata:a},null,o),d=e=t.value,a&&Object.defineProperty(e,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:a}),b(e,o)})(),d=e})();export{re as DtdValidator,Z as RelaxNGValidator,x as XmlValidateError,$ as XsdValidator};
